updated code prompted by the amazon whisperer
